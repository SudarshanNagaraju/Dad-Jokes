{"ast":null,"code":"import _objectSpread from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/src/JokeList.js\";\nimport React, { Component } from \"react\";\nimport Joke from \"./Joke\";\nimport axios from \"axios\";\nimport uuid from \"uuid/v4\";\nimport \"./JokeList.css\";\n\nvar JokeList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(JokeList, _Component);\n\n  function JokeList(props) {\n    var _this;\n\n    _classCallCheck(this, JokeList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(JokeList).call(this, props));\n    _this.state = {\n      jokes: JSON.parse(window.localStorage.getItem(\"jokes\") || \"[]\"),\n      loading: false\n    };\n    _this.seenJokes = new Set(_this.state.jokes.map(function (j) {\n      return j.text;\n    }));\n    console.log(_this.seenJokes);\n    _this.handleClick = _this.handleClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(JokeList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.state.jokes.length === 0) this.getJokes();\n    }\n  }, {\n    key: \"getJokes\",\n    value: function () {\n      var _getJokes = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var jokes, res, newJoke;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                jokes = [];\n\n              case 2:\n                if (!(jokes.length < this.props.numJokesToGet)) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 5;\n                return axios.get(\"https://icanhazdadjoke.com/\", {\n                  headers: {\n                    Accept: \"application/json\"\n                  }\n                });\n\n              case 5:\n                res = _context.sent;\n                newJoke = res.data.joke;\n\n                if (!this.seenJokes.has(newJoke)) {\n                  jokes.push({\n                    id: uuid(),\n                    text: newJoke,\n                    votes: 0\n                  });\n                } else {\n                  console.log(\"FOUND A DUPLICATE!\");\n                  console.log(newJoke);\n                }\n\n                _context.next = 2;\n                break;\n\n              case 10:\n                this.setState(function (st) {\n                  return {\n                    loading: false,\n                    jokes: [].concat(_toConsumableArray(st.jokes), jokes)\n                  };\n                }, function () {\n                  return window.localStorage.setItem(\"jokes\", JSON.stringify(_this2.state.jokes));\n                });\n                _context.next = 17;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](0);\n                alert(_context.t0);\n                this.setState({\n                  loading: false\n                });\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 13]]);\n      }));\n\n      function getJokes() {\n        return _getJokes.apply(this, arguments);\n      }\n\n      return getJokes;\n    }()\n  }, {\n    key: \"handleVote\",\n    value: function handleVote(id, delta) {\n      var _this3 = this;\n\n      this.setState(function (st) {\n        return {\n          jokes: st.jokes.map(function (j) {\n            return j.id === id ? _objectSpread({}, j, {\n              votes: j.votes + delta\n            }) : j;\n          })\n        };\n      }, function () {\n        return window.localStorage.setItem(\"jokes\", JSON.stringify(_this3.state.jokes));\n      });\n    }\n  }, {\n    key: \"handleClick\",\n    value: function handleClick() {\n      this.setState({\n        loading: true\n      }, this.getJokes);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      if (this.state.loading) {\n        return React.createElement(\"div\", {\n          className: \"JokeList-spinner\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"far fa-8x fa-laugh fa-spin\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70\n          },\n          __self: this\n        }), React.createElement(\"h1\", {\n          className: \"JokeList-title\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71\n          },\n          __self: this\n        }, \"Loading...\"));\n      }\n\n      var jokes = this.state.jokes.sort(function (a, b) {\n        return b.votes - a.votes;\n      });\n      return React.createElement(\"div\", {\n        className: \"JokeList\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"JokeList-sidebar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"JokeList-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, \"Dad\"), \" Jokes\"), React.createElement(\"img\", {\n        src: \"https://assets.dryicons.com/uploads/icon/svg/8927/0eb14c71-38f2-433a-bfc8-23d9c99b3647.svg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        className: \"JokeList-getmore\",\n        onClick: this.handleClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, \"Fetch Jokes\")), React.createElement(\"div\", {\n        className: \"JokeList-jokes\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, jokes.map(function (j) {\n        return React.createElement(Joke, {\n          key: j.id,\n          votes: j.votes,\n          text: j.text,\n          upvote: function upvote() {\n            return _this4.handleVote(j.id, 1);\n          },\n          downvote: function downvote() {\n            return _this4.handleVote(j.id, -1);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        });\n      })));\n    }\n  }]);\n\n  return JokeList;\n}(Component);\n\nJokeList.defaultProps = {\n  numJokesToGet: 10\n};\nexport default JokeList;","map":{"version":3,"sources":["/Users/sudarshan/Documents/React/personalProjects/dad-jokes-project/src/JokeList.js"],"names":["React","Component","Joke","axios","uuid","JokeList","props","state","jokes","JSON","parse","window","localStorage","getItem","loading","seenJokes","Set","map","j","text","console","log","handleClick","bind","length","getJokes","numJokesToGet","get","headers","Accept","res","newJoke","data","joke","has","push","id","votes","setState","st","setItem","stringify","alert","delta","sort","a","b","handleVote","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Joke from \"./Joke\";\nimport axios from \"axios\";\nimport uuid from \"uuid/v4\";\nimport \"./JokeList.css\";\n\nclass JokeList extends Component {\n  static defaultProps = {\n    numJokesToGet: 10\n  };\n  constructor(props) {\n    super(props);\n    this.state = {\n      jokes: JSON.parse(window.localStorage.getItem(\"jokes\") || \"[]\"),\n      loading: false\n    };\n    this.seenJokes = new Set(this.state.jokes.map(j => j.text));\n    console.log(this.seenJokes);\n    this.handleClick = this.handleClick.bind(this);\n  }\n  componentDidMount() {\n    if (this.state.jokes.length === 0) this.getJokes();\n  }\n  async getJokes() {\n    try {\n      let jokes = [];\n      while (jokes.length < this.props.numJokesToGet) {\n        let res = await axios.get(\"https://icanhazdadjoke.com/\", {\n          headers: { Accept: \"application/json\" }\n        });\n        let newJoke = res.data.joke;\n        if (!this.seenJokes.has(newJoke)) {\n          jokes.push({ id: uuid(), text: newJoke, votes: 0 });\n        } else {\n          console.log(\"FOUND A DUPLICATE!\");\n          console.log(newJoke);\n        }\n      }\n      this.setState(\n        st => ({\n          loading: false,\n          jokes: [...st.jokes, ...jokes]\n        }),\n        () =>\n          window.localStorage.setItem(\"jokes\", JSON.stringify(this.state.jokes))\n      );\n    } catch (e) {\n      alert(e);\n      this.setState({ loading: false });\n    }\n  }\n  handleVote(id, delta) {\n    this.setState(\n      st => ({\n        jokes: st.jokes.map(j =>\n          j.id === id ? { ...j, votes: j.votes + delta } : j\n        )\n      }),\n      () =>\n        window.localStorage.setItem(\"jokes\", JSON.stringify(this.state.jokes))\n    );\n  }\n  handleClick() {\n    this.setState({ loading: true }, this.getJokes);\n  }\n  render() {\n    if (this.state.loading) {\n      return (\n        <div className='JokeList-spinner'>\n          <i className='far fa-8x fa-laugh fa-spin' />\n          <h1 className='JokeList-title'>Loading...</h1>\n        </div>\n      );\n    }\n    let jokes = this.state.jokes.sort((a, b) => b.votes - a.votes);\n    return (\n      <div className='JokeList'>\n        <div className='JokeList-sidebar'>\n          <h1 className='JokeList-title'>\n            <span>Dad</span> Jokes\n          </h1>\n          <img src='https://assets.dryicons.com/uploads/icon/svg/8927/0eb14c71-38f2-433a-bfc8-23d9c99b3647.svg' />\n          <button className='JokeList-getmore' onClick={this.handleClick}>\n            Fetch Jokes\n          </button>\n        </div>\n\n        <div className='JokeList-jokes'>\n          {jokes.map(j => (\n            <Joke\n              key={j.id}\n              votes={j.votes}\n              text={j.text}\n              upvote={() => this.handleVote(j.id, 1)}\n              downvote={() => this.handleVote(j.id, -1)}\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n}\nexport default JokeList;\n"]},"metadata":{},"sourceType":"module"}